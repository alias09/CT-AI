<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h1 class="mb-0">Результаты исследования</h1>
      <p class="text-muted mb-0">Файл: <%= @upload.original_filename %></p>
    </div>
    <%= link_to 'Назад к истории', history_path, class: 'btn btn-secondary' %>
  </div>

  <div class="card mb-4">
    <div class="card-body">
      <h5 class="card-title">Сводка анализа</h5>
      <p class="card-text">
        <strong>Обнаружена патология:</strong> <%= pathology_badge(@upload.pathology) %>
      </p>
      <p class="card-text">
        <strong>Максимальная вероятность патологии:</strong> <%= number_to_percentage(@upload.probability_of_pathology * 100, precision: 2) %>
      </p>
    </div>
  </div>

  <h3 class="mt-4">Срезы (отсортированы по вероятности)</h3>
  <div class="row">
    <% if @sorted_slices.any? %>
      <% @sorted_slices.each do |slice| %>
        <% image_path = File.join(@base_image_path, slice['filename']) %>
        <div class="col-md-3 mb-4">
          <div class="card h-100">
            <%= image_tag image_path, class: 'card-img-top', alt: slice['filename'] %>
            <div class="card-body text-center">
              <h6 class="card-title"><%= number_to_percentage(slice['probability'] * 100, precision: 2) %></h6>
              <p class="card-text text-muted small"><%= slice['filename'] %></p>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="col">
        <p class="text-muted">Нет изображений для отображения.</p>
      </div>
    <% end %>
  </div>
</div>
